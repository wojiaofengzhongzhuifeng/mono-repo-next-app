openapi: 3.0.0
info:
  title: 用户认证 API
  version: 1.0.0
  description: 用户注册、登录和获取用户信息接口
servers:
  - url: http://localhost:3010/api
    description: 本地开发服务器
tags:
  - name: Auth
    description: 用户认证相关接口
  - name: User
    description: 用户信息相关接口
paths:
  /auth/register:
    post:
      tags:
        - Auth
      summary: 用户注册
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
                - password
              properties:
                email:
                  type: string
                  format: email
                  description: 用户邮箱
                  example: user@example.com
                password:
                  type: string
                  min_length: 6
                  description: 用户密码 (至少6个字符)
                  example: password123
      responses:
        '200':
          description: 注册成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthSuccessResponse'
        '400':
          description: 客户端错误 (如邮箱已存在、密码不符合要求)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: 服务器内部错误
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /auth/login:
    post:
      tags:
        - Auth
      summary: 用户登录
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
                - password
              properties:
                email:
                  type: string
                  format: email
                  description: 用户邮箱
                  example: user@example.com
                password:
                  type: string
                  description: 用户密码
                  example: password123
      responses:
        '200':
          description: 登录成功，返回 JWT Token 和用户信息
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LoginSuccessResponse'
        '400':
          description: 客户端错误 (如邮箱或密码不正确)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: 服务器内部错误
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /user/me:
    get:
      tags:
        - User
      summary: 获取当前用户信息
      security:
        - bearerAuth: []
      responses:
        '200':
          description: 成功获取用户信息
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserSuccessResponse'
        '401':
          description: 未授权 (缺少或无效 Token)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: 用户不存在
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: 服务器内部错误
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  schemas:
    User:
      type: object
      properties:
        id:
          type: string
          format: uuid
          example: 'uuid-example-123'
        email:
          type: string
          format: email
          example: user@example.com
        createdAt:
          type: string
          format: date-time
          example: '2023-10-27T10:00:00Z'
    AuthSuccessResponse:
      type: object
      properties:
        code:
          type: number
          example: 20000
        message:
          type: string
          example: 注册成功
        data:
          $ref: '#/components/schemas/User'
    LoginSuccessResponse:
      type: object
      properties:
        code:
          type: number
          example: 20000
        message:
          type: string
          example: 登录成功
        data:
          type: object
          properties:
            token:
              type: string
              description: JWT 认证Token
              example: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...'
            user:
              $ref: '#/components/schemas/User'
    UserSuccessResponse:
      type: object
      properties:
        code:
          type: number
          example: 20000
        message:
          type: string
          example: 获取用户信息成功
        data:
          $ref: '#/components/schemas/User'
    ErrorResponse:
      type: object
      properties:
        code:
          type: number
          example: 40001
        message:
          type: string
          example: 客户端错误
        data:
          type: object
          nullable: true
          description: 错误详情 (可选)
